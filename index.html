
<!DOCTYPE html>
<html>

<! http://underscorejs.org/#sample documentation for this library >
<script src ="Underscore.js" type="text/javascript">
</script>

<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Aeon's End Randomizer</title>
	<link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>

<img src = "images/title.jpg" align="middle" width ="60%">

<p> Which Expansions are you playing with? </p>
<form>
  <input type="checkbox" name="expansions" value="Expansion"> Depths <br>
  <input type="checkbox" name="expansions" value="Stretch"> Nameless <br>
</form>


<p>How would you like to randomize your setup?</p>

<form>
  <input type="radio" name="setup" value="random" checked="checked">Balanced<br>
  <input type="radio" name="setup" value="one">Market Setup 1<br>
  <input type="radio" name="setup" value="two">Market Setup 2<br>
  <input type="radio" name="setup" value="three">Market Setup 3<br>
  <input type="radio" name="setup" value="four">Market Setup 4<br>
  <input type="radio" name="setup" value="five">Market Setup 5<br>
  <input type="radio" name="setup" value="six">Market Setup 6<br>
</form>

<br>

<form>
<input type="button" onclick="buttonPress()" value="Make Market!">
</form>
  <p><span id="market"></span></p>
  <p><span id="expo"></span></p>

  <img src="images/Blank.png" id="image0" width="30%"/>
  <img src="images/Blank.png" id="image1" width="30%"/>
  <img src="images/Blank.png" id="image2" width="30%"/>
  <br>
  <img src="images/Blank.png" id="image3" width="30%"/>
  <img src="images/Blank.png" id="image4" width="30%"/>
  <img src="images/Blank.png" id="image5" width="30%"/>
  <br>
  <img src="images/Blank.png" id="image6" width="30%"/>
  <img src="images/Blank.png" id="image7" width="30%"/>
  <img src="images/Blank.png" id="image8" width="30%"/>

<script language="JavaScript">

var Card = function(name, cardType, cost, expansion){
	this.name = name;
	this.cardType = cardType;
	this.cost = cost;
	this.expansion = expansion;
	
};

Card.prototype.toString = function(){
	return this.name;
};

cardsGem = [new Card("Jade", 'Gem', 2, 'Base'),new Card("SiftersPearl", 'Gem', 3, 'Base'),new Card("VriswoodAmber", 'Gem', 3, 'Base'),new Card("LeechingAgate", 'Gem', 3, 'Stretch'),new Card("DiamondCluster", 'Gem', 4, 'Base'),new Card("SearingRuby", 'Gem', 4, 'Base'),new Card("BurningOpal", 'Gem', 5, 'Base'),new Card("BanishingTopaz", 'Gem', 5, 'Expansion'),new Card("CloudedSapphire", 'Gem', 6, 'Base')];
cardsSpell = [new Card("PhoenixFlame", 'Spell', 3, 'Base'),new Card("SpectralEcho", 'Spell', 3, 'Base'),new Card("AmplifyVision", 'Spell', 4, 'Base'),new Card("Ignite", 'Spell', 4, 'Base'),new Card("LavaTendril", 'Spell', 4, 'Base'),new Card("VoidBond", 'Spell', 4, 'Expansion'),new Card("Blaze", 'Spell', 4, 'Stretch'),new Card("DarkFire", 'Spell', 5, 'Base'),new Card("EssenceTheft", 'Spell', 5, 'Base'),new Card("FeralLightning", 'Spell', 5, 'Base'),new Card("OblivionSwell", 'Spell', 5, 'Base'),new Card("Combustion", 'Spell', 5, 'Expansion'),new Card("ChaosArc", 'Spell', 6, 'Base'),new Card("PlanarInsight", 'Spell', 6, 'Base'),new Card("WildfireWhip", 'Spell', 6, 'Base'),new Card("DevouringShadow", 'Spell', 6, 'Expansion'),new Card("ScryingBolt", 'Spell', 6, 'Stretch'),new Card("ArcaneNexus", 'Spell', 7, 'Base'),new Card("ConsumingVoid", 'Spell', 7, 'Base'),new Card("DisintegratingScythe", 'Spell', 7, 'Expansion'),new Card("SagesBrand", 'Spell', 7, 'Stretch'),new Card("MonstrousInferno", 'Spell', 8, 'Expansion'),new Card("Radiance", 'Spell', 8, 'Stretch')];
cardsRelic = [new Card("FlexingDagger", 'Relic', 2, 'Base'),new Card("BottledVortex", 'Relic', 3, 'Base'),new Card("UnstablePrism", 'Relic', 3, 'Base'),new Card("BlastingStaff", 'Relic', 4, 'Base'),new Card("FocusingOrb", 'Relic', 4, 'Base'),new Card("Transmogrifier", 'Relic', 4, 'Expansion'),new Card("VimDynamo", 'Relic', 4, 'Expansion'),new Card("MagesTalisman", 'Relic', 5, 'Base'),new Card("MoltenHammer", 'Relic', 5, 'Stretch'),new Card("TemporalHelix", 'Relic', 7, 'Stretch')];

exps = ["Base", "Expansion", "Stretch"]

pickGems = function(num=3){
	return _.sample(cardsGem,num);
};

pickSpells = function(num=4){
	return _.sample(cardsSpell,num);
};

pickRelics = function(num=2){
	return _.sample(cardsRelic,num);
};

inExp = function(card){
	inExpo = 0;
	for(j = 0; j < exps.length; j++){
		if(card.expansion == exps[j]){
			inExpo = 1;
		}
	}
	return inExpo;
};

randomSetup = function(gems, relics, spells) {
	return _.sample(gems, 3).concat(_.sample(relics, 2)).concat(_.sample(spells, 4));
};

setupOne = function(gems, relics, spells) {
	var cards = [];
	var smallGems = gems.filter(function(gem) {return gem.cost < 4});
	var smallGem = _.sample(smallGems);
	cards.push(smallGem);
	var index = gems.indexOf(smallGem);
	gems.splice(index,1);
	var fourGems =  gems.filter(function(gem) {return gem.cost == 4});
	var fourGem = _.sample(fourGems);
	cards.push(fourGem);
	var index = gems.indexOf(fourGem);
	gems.splice(index,1);
	cards.push(_.sample(gems));

	cards = cards.concat(_.sample(relics,2));
	
	var smallSpells = spells.filter(function(spell) {return spell.cost < 5});
	cards = cards.concat(_.sample(smallSpells,2));
	var bigSpells = spells.filter(function(spell) {return spell.cost > 5});
	cards = cards.concat(_.sample(bigSpells,2));
	return cards;
};

setupTwo = function(gems, relics, spells) {
	var cards = [];
	var largeGems = gems.filter(function(gem) {return gem.cost > 3});
	cards = cards.concat(_.sample(largeGems, 3));

	var largeRelics = relics.filter(function(relic) {return relic.cost > 4});
	var largeRelic = _.sample(largeRelics);
	cards.push(largeRelic);
	var index = relics.indexOf(largeRelic);
	relics.splice(index,1);
	cards.push(_.sample(relics));
	
	var smallSpells = spells.filter(function(spell) {return spell.cost < 6});
	cards = cards.concat(_.sample(smallSpells,3));
	var bigSpells = spells.filter(function(spell) {return spell.cost > 6});
	cards = cards.concat(_.sample(bigSpells,1));
	return cards;
};

setupThree = function(gems, relics, spells) {
	var cards = [];
	var smallGems = gems.filter(function(gem) {return gem.cost < 4});
	var largeGems = gems.filter(function(gem) {return gem.cost == 4 || gem.cost == 5});
	cards.push(_.sample(smallGems));
	cards = cards.concat(_.sample(largeGems, 2));
	
	cards.push(_.sample(relics));
	
	var threeSpells = spells.filter(function(spell) {return spell.cost == 3});
	cards.push(_.sample(threeSpells));
	var fourSpells = spells.filter(function(spell) {return spell.cost == 4});
	cards.push(_.sample(fourSpells));
	var bigSpells = spells.filter(function(spell) {return spell.cost > 5});
	cards = cards.concat(_.sample(bigSpells,3));
	return cards;
};

setupFour = function(gems, relics, spells) {
	var cards = [];
	var largeGems = gems.filter(function(gem) {return gem.cost > 4});
	var largeGem = _.sample(largeGems);
	cards.push(largeGem);
	var index = gems.indexOf(largeGem);
	gems.splice(index,1);
	cards = cards.concat(_.sample(gems,2));
	
	var smallRelics = relics.filter(function(relic) {return relic.cost < 4});
	var smallRelic = _.sample(smallRelics);
	cards.push(smallRelic);
	var index = relics.indexOf(smallRelic);
	relics.splice(index,1);
	var largeRelics = relics.filter(function(relic) {return relic.cost > 4});
	var largeRelic = _.sample(largeRelics);
	cards.push(largeRelic);
	var index = relics.indexOf(largeRelic);
	relics.splice(index,1);
	cards.push(_.sample(relics));
	
	var smallSpells = spells.filter(function(spell) {return spell.cost < 5});
	var smallSpell = _.sample(smallSpells);
	cards.push(smallSpell);
	var index = spells.indexOf(smallSpell);
	spells.splice(index,1);
	var largeSpells = spells.filter(function(spell) {return spell.cost > 5});
	var largeSpell = _.sample(largeSpells);
	cards.push(largeSpell);
	var index = spells.indexOf(largeSpell);
	spells.splice(index,1);
	cards.push(_.sample(spells));
	return cards;
};


setupFive = function(gems, relics, spells) {
	var cards = [];
	var twoGems = gems.filter(function(gem) {return gem.cost== 2});
	cards.push(_.sample(twoGems));
	var threeGems = gems.filter(function(gem) {return gem.cost== 3});
	cards.push(_.sample(threeGems));
	var fourGems = gems.filter(function(gem) {return gem.cost== 4});
	cards.push(_.sample(fourGems));
	var fiveGems = gems.filter(function(gem) {return gem.cost== 5});
	cards.push(_.sample(fiveGems));
	
	cards.push(_.sample(relics));
	
	var fourSpells = spells.filter(function(spell) {return spell.cost == 4});
	cards.push(_.sample(fourSpells));
	var fiveSpells = spells.filter(function(spell) {return spell.cost == 5});
	cards.push(_.sample(fiveSpells));
	var sixSpells = spells.filter(function(spell) {return spell.cost == 6});
	cards.push(_.sample(sixSpells));
	var largeSpells = spells.filter(function(spell) {return spell.cost >6});
	cards.push(_.sample(largeSpells));
	return cards;
};

setupSix = function(gems, relics, spells) {
	var cards = [];
	var threeGems = gems.filter(function(gem) {return gem.cost== 3});
	cards.push(_.sample(threeGems));
	var fourGems = gems.filter(function(gem) {return gem.cost== 4});
	cards.push(_.sample(fourGems));
	
	
	var smallRelics = relics.filter(function(relic) {return relic.cost < 4});
	var smallRelic = _.sample(smallRelics);
	cards.push(smallRelic);
	var index = relics.indexOf(smallRelic);
	relics.splice(index,1);
	var largeRelics = relics.filter(function(relic) {return relic.cost > 4});
	var largeRelic = _.sample(largeRelics);
	cards.push(largeRelic);
	var index = relics.indexOf(largeRelic);
	relics.splice(index,1);
	cards.push(_.sample(relics));
	
	var smallSpells = spells.filter(function(spell) {return spell.cost == 3 || spell.cost == 4});
	cards.push(_.sample(smallSpells));
	var medSpells = spells.filter(function(spell) {return spell.cost == 5 || spell.cost == 6});
	cards = cards.concat(_.sample(medSpells,2));
	var largeSpells = spells.filter(function(spell) {return spell.cost >6});
	cards.push(_.sample(largeSpells));
	return cards;
};


genMarket = function(gems, relics, spells, i){
	var cards = [];
	if (i == 0) {
		cards = randomSetup(gems, relics, spells);
	}
	if (i == 1) {
		cards = setupOne(gems, relics, spells);
	}
	if (i == 2) {
		cards = setupTwo(gems, relics, spells);
	}
	if (i == 3) {
		cards = setupThree(gems, relics, spells);
	}
	if (i == 4) {
		cards = setupFour(gems, relics, spells);
	}
	if (i == 5) {
		cards = setupFive(gems, relics, spells);
	}
	if (i == 6) {
		cards = setupSix(gems, relics, spells);
	}
	return cards;
};

function buttonPress() {
	document.getElementById('image4').scrollIntoView();
	var checkExp = document.forms[0];
	exps = ["Base"];
	for (i = 0; i < checkExp.length; i++) {
        if (checkExp[i].checked) {
            exps.push(checkExp[i].value);
        }
    }
	var fGems = cardsGem.filter(inExp);
	var fRelics = cardsRelic.filter(inExp);
	var fSpells = cardsSpell.filter(inExp);
    var checkSetup = document.forms[1];
    var txt = "";
	var cards = [];
    for (i = 0; i < checkSetup.length; i++) {
        if (checkSetup[i].checked) {
            txt = txt + checkSetup[i].value + " ";
			cards = genMarket(fGems, fRelics, fSpells, i);
        }
    }
    for (i = 0; i < cards.length; i++) {
		var imageName = "image"+ i.toString();
        document.getElementById(imageName).src="images/" + cards[i] +".png";
    }	
    //document.getElementById("market").innerHTML = "You ordered a market with: " + txt;
	//document.getElementById("expo").innerHTML = "You want to use expansions: " + exps+fGems;
	
}

window.onload = function() {
  buttonPress();
};

</script>


</body>
</html>